<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¹ãƒãƒ¼ãƒ„ã‚³ãƒ¼ãƒ€ãƒ¼ç›£è¦–ä½œæ¥­è¨˜éŒ²</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 24px;
        }
        
        h1 {
            color: #333;
            margin-bottom: 24px;
            font-size: 24px;
        }
        
        h2 {
            color: #555;
            margin: 24px 0 16px;
            font-size: 18px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 8px;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        label {
            display: block;
            color: #666;
            font-size: 14px;
            margin-bottom: 4px;
            font-weight: 500;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.2s;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #4CAF50;
        }
        
        .grid {
            display: grid;
            gap: 16px;
        }
        
        .grid-2 {
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        }
        
        .grid-3 {
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        }
        
        .grid-4 {
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        }
        
        .sc-inputs {
            display: grid;
            grid-template-columns: auto 1fr 1fr 1fr;
            gap: 8px;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .sc-cpu-inputs {
            display: grid;
            grid-template-columns: auto 1fr 1fr;
            gap: 8px;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .sc-label {
            font-weight: 500;
            color: #555;
        }
        
        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 32px;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background-color: #4CAF50;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #45a049;
        }
        
        .btn-secondary {
            background-color: #757575;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #616161;
        }
        
        .alert {
            padding: 16px;
            border-radius: 6px;
            margin-bottom: 20px;
            display: none;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .alert-info {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }
        
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #4CAF50;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .config-section {
            background: #f9f9f9;
            padding: 16px;
            border-radius: 6px;
            margin-bottom: 24px;
        }
        
        .config-info {
            font-size: 14px;
            color: #666;
            margin-top: 8px;
        }
        
        .btn-excel {
            background-color: #217346;
            color: white;
        }
        
        .btn-excel:hover {
            background-color: #1e6b3e;
        }
        
        .btn-csv {
            background-color: #e67e22;
            color: white;
        }
        
        .btn-csv:hover {
            background-color: #d35400;
        }
        
        .tabs {
            display: flex;
            border-bottom: 2px solid #e0e0e0;
            margin-bottom: 24px;
        }
        
        .tab {
            padding: 12px 24px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
        }
        
        .tab.active {
            color: #4CAF50;
            border-bottom-color: #4CAF50;
        }
        
        .tab:hover {
            color: #4CAF50;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }

        @media (max-width: 600px) {
            .container {
                padding: 16px;
            }
            
            .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
            }
            
            .sc-inputs {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                text-align: left;
            }
        }
    </style>
</head>
<body>
    <div class="loading" id="loading">
        <div class="spinner"></div>
    </div>
    
    <div class="container">
        <h1>ã‚¹ãƒãƒ¼ãƒ„ã‚³ãƒ¼ãƒ€ãƒ¼ HWç›£è¦–ä½œæ¥­è¨˜éŒ²</h1>
        
        <div id="alert" class="alert"></div>
        
        <!-- ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('monitoring')">ğŸ“‹ ç›£è¦–è¨˜éŒ²å…¥åŠ›</button>
            <button class="tab" onclick="switchTab('github')">ğŸ“¤ GitHubé€ä¿¡</button>
            <button class="tab" onclick="switchTab('local')">ğŸ’¾ ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜</button>
        </div>
        
        <!-- ç›£è¦–è¨˜éŒ²å…¥åŠ›ã‚¿ãƒ– -->
        <div id="monitoring-tab" class="tab-content active">
            <form id="monitoringForm">
            <!-- åŸºæœ¬æƒ…å ± -->
            <h2>åŸºæœ¬æƒ…å ±</h2>
            <div class="grid grid-3">
                <div class="form-group">
                    <label for="date">ç¢ºèªæ—¥</label>
                    <input type="text" id="date" name="date" placeholder="2021/12/7" required>
                </div>
                <div class="form-group">
                    <label for="time">ç¢ºèªæ™‚åˆ»</label>
                    <input type="time" id="time" name="time" required>
                </div>
                <div class="form-group">
                    <label for="checker">ç¢ºèªè€…</label>
                    <input type="text" id="checker" name="checker" placeholder="åå‰ã‚’å…¥åŠ›" required>
                </div>
            </div>
            
            <div class="grid grid-2">
                <div class="form-group">
                    <label for="checkResult">ç¢ºèªçµæœ</label>
                    <input type="text" id="checkResult" name="checkResult" placeholder="å•é¡Œãªã—" value="å•é¡Œãªã—">
                </div>
                <div class="form-group">
                    <label for="serverTimeSync">ã‚µãƒ¼ãƒæ™‚åˆ»åŒæœŸ</label>
                    <input type="text" id="serverTimeSync" name="serverTimeSync" placeholder="å•é¡Œãªã—" value="å•é¡Œãªã—">
                </div>
            </div>
            
            <!-- FTã‚µãƒ¼ãƒãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ -->
            <h2>FTã‚µãƒ¼ãƒãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£</h2>
            <div class="grid grid-2">
                <div class="form-group">
                    <label for="cpuPciModule">CPUãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€PCIãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«</label>
                    <select id="cpuPciModule" name="cpuPciModule">
                        <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                        <option value="Duplex">Duplex</option>
                        <option value="Simplex">Simplex</option>
                        <option value="Error">Error</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="scsiEnclosure">SCSIã‚¨ãƒ³ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£</label>
                    <select id="scsiEnclosure" name="scsiEnclosure">
                        <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                        <option value="Online">Online</option>
                        <option value="Offline">Offline</option>
                        <option value="Error">Error</option>
                    </select>
                </div>
            </div>
            
            <!-- HDDæ®‹å®¹é‡ -->
            <h2>HDDæ®‹å®¹é‡</h2>
            <div class="grid grid-4">
                <div class="form-group">
                    <label for="driveC">C: [GB]</label>
                    <input type="number" id="driveC" name="driveC" step="0.1" placeholder="45">
                </div>
                <div class="form-group">
                    <label for="driveD">D: [GB]</label>
                    <input type="number" id="driveD" name="driveD" step="0.1" placeholder="197">
                </div>
                <div class="form-group">
                    <label for="driveE">E: [GB]</label>
                    <input type="number" id="driveE" name="driveE" step="0.1" placeholder="588">
                </div>
                <div class="form-group">
                    <label for="driveY">Y: [GB]</label>
                    <input type="number" id="driveY" name="driveY" step="0.1" placeholder="588">
                </div>
            </div>
            <div class="form-group" style="max-width: 200px;">
                <label for="driveZ">Z: [TB]</label>
                <input type="number" id="driveZ" name="driveZ" step="0.01" placeholder="2.48">
            </div>
            
            <!-- ãƒ¡ãƒ¢ãƒªãƒ»CPU -->
            <h2>ãƒ¡ãƒ¢ãƒªãƒ»CPUä½¿ç”¨çŠ¶æ³</h2>
            <div class="grid grid-2">
                <div class="form-group">
                    <label for="sqlServerMemory">SQLServerãƒ¡ãƒ¢ãƒª [GB]</label>
                    <input type="number" id="sqlServerMemory" name="sqlServerMemory" step="0.01" placeholder="4.19">
                </div>
                <div class="form-group">
                    <label for="totalMemory">å…¨ä½“ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ [GB]</label>
                    <input type="number" id="totalMemory" name="totalMemory" step="0.01" placeholder="9">
                </div>
                <div class="form-group">
                    <label for="cpuUsage">CPUä½¿ç”¨ç‡ [%]</label>
                    <input type="number" id="cpuUsage" name="cpuUsage" min="0" max="100" placeholder="1">
                </div>
                <div class="form-group">
                    <label for="cpuUsageTime">CPUç¢ºèªæ™‚åˆ»</label>
                    <input type="time" id="cpuUsageTime" name="cpuUsageTime">
                </div>
            </div>
            
            <div class="form-group">
                <label for="memoryUsageStatus">ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡çŠ¶æ³</label>
                <input type="text" id="memoryUsageStatus" name="memoryUsageStatus" placeholder="å•é¡Œãªã—" value="å•é¡Œãªã—">
            </div>
            
            <!-- ã‚µãƒ¼ãƒãƒ¼ãƒ©ãƒ³ãƒ— -->
            <h2>ã‚µãƒ¼ãƒãƒ¼ãƒ©ãƒ³ãƒ—ç‚¹ç¯æ•°</h2>
            <div class="grid grid-2">
                <div class="form-group">
                    <label for="upperLamps">ä¸Šæ®µã‚µãƒ¼ãƒãƒ©ãƒ³ãƒ— [å€‹]</label>
                    <input type="number" id="upperLamps" name="upperLamps" min="0" placeholder="3">
                </div>
                <div class="form-group">
                    <label for="lowerLamps">ä¸‹æ®µã‚µãƒ¼ãƒãƒ©ãƒ³ãƒ— [å€‹]</label>
                    <input type="number" id="lowerLamps" name="lowerLamps" min="0" placeholder="2">
                </div>
            </div>
            
            <!-- SCæ©Ÿ -->
            <h2>SCæ©Ÿ HDDæ®‹å®¹é‡ [GB]</h2>
            <div id="scMachines">
                <!-- SC-1 ã‹ã‚‰ SC-12 ã¾ã§å‹•çš„ã«ç”Ÿæˆ -->
            </div>
            
            <!-- SCæ©Ÿ CPU[%]/ãƒ¡ãƒ¢ãƒª[GB] -->
            <h2>SCæ©Ÿ CPU[%]/ãƒ¡ãƒ¢ãƒª[GB]</h2>
            <div id="scCpuMemory">
                <!-- SC-1 ã‹ã‚‰ SC-12 ã®CPU/ãƒ¡ãƒ¢ãƒªæƒ…å ±ã‚’å‹•çš„ã«ç”Ÿæˆ -->
            </div>
            
            <!-- å‚™è€ƒ -->
            <h2>å‚™è€ƒ</h2>
            <div class="form-group">
                <textarea id="notes" name="notes" rows="3" placeholder="ç‰¹è¨˜äº‹é …ãŒã‚ã‚Œã°å…¥åŠ›ã—ã¦ãã ã•ã„"></textarea>
            </div>
            
                <!-- ä¸€æ™‚ä¿å­˜ãƒœã‚¿ãƒ³ -->
                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="saveToLocal()">
                        ğŸ“¥ ä¸€æ™‚ä¿å­˜
                    </button>
                </div>
            </form>
        </div>
        
        <!-- GitHubé€ä¿¡ã‚¿ãƒ– -->
        <div id="github-tab" class="tab-content">
            <div class="config-section">
                <h2>GitHubè¨­å®š</h2>
                <div class="form-group">
                    <label for="githubToken">GitHub Personal Access Token</label>
                    <input type="password" id="githubToken" placeholder="ghp_xxxxxxxxxxxxxx">
                    <div class="config-info">
                        â€» åˆå›ã®ã¿å…¥åŠ›ãŒå¿…è¦ã§ã™ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚
                        <a href="https://github.com/settings/tokens/new?scopes=repo" target="_blank">ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”Ÿæˆ</a>
                    </div>
                </div>
                <div class="grid grid-2">
                    <div class="form-group">
                        <label for="repoOwner">ãƒªãƒã‚¸ãƒˆãƒªã‚ªãƒ¼ãƒŠãƒ¼</label>
                        <input type="text" id="repoOwner" placeholder="ã‚ãªãŸã®GitHubãƒ¦ãƒ¼ã‚¶ãƒ¼å">
                    </div>
                    <div class="form-group">
                        <label for="repoName">ãƒªãƒã‚¸ãƒˆãƒªå</label>
                        <input type="text" id="repoName" placeholder="server_monitor_tools">
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="button" class="btn-primary" onclick="submitToGitHub()">
                        ğŸ“¤ GitHubã«é€ä¿¡
                    </button>
                </div>
            </div>
        </div>
        
        <!-- ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜ã‚¿ãƒ– -->
        <div id="local-tab" class="tab-content">
            <div class="config-section">
                <h2>ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜ã‚ªãƒ—ã‚·ãƒ§ãƒ³</h2>
                <p class="config-info">å…¥åŠ›ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜ã§ãã¾ã™ã€‚</p>
                
                <div class="button-group">
                    <button type="button" class="btn-excel" onclick="downloadJSON()">
                        ğŸ“ JSONã§ä¿å­˜
                    </button>
                    <button type="button" class="btn-csv" onclick="downloadCSV()">
                        ğŸ“Š CSVã§ä¿å­˜
                    </button>
                </div>
                
                <div class="config-info" style="margin-top: 20px;">
                    <h3>ä½¿ç”¨æ–¹æ³•:</h3>
                    <ul>
                        <li><strong>JSONã§ä¿å­˜:</strong> ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸJSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã§Excelã«å¤‰æ›</li>
                        <li><strong>CSVã§ä¿å­˜:</strong> Excelã§ç›´æ¥é–‹ã„ã¦ç¢ºèªå¯èƒ½</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // åˆæœŸè¨­å®š
        document.addEventListener('DOMContentLoaded', function() {
            // ç¾åœ¨ã®æ—¥æ™‚ã‚’è¨­å®šï¼ˆ2021/12/7å½¢å¼ï¼‰
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth() + 1;
            const day = now.getDate();
            document.getElementById('date').value = `${year}/${month}/${day}`;
            document.getElementById('time').value = now.toTimeString().split(' ')[0].substring(0, 5);
            
            // ä¿å­˜ã•ã‚ŒãŸè¨­å®šã‚’èª­ã¿è¾¼ã‚€
            loadConfig();
            
            // SCæ©Ÿã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç”Ÿæˆ
            generateSCInputs();
            
            // SCæ©ŸCPU/ãƒ¡ãƒ¢ãƒªã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç”Ÿæˆ
            generateSCCpuMemoryInputs();
            
            // ä¿å­˜ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Œã°èª­ã¿è¾¼ã‚€
            loadSavedData();
        });
        
        // SCæ©Ÿã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å‹•çš„ã«ç”Ÿæˆ
        function generateSCInputs() {
            const container = document.getElementById('scMachines');
            for (let i = 1; i <= 12; i++) {
                const div = document.createElement('div');
                div.className = 'sc-inputs';
                div.innerHTML = `
                    <span class="sc-label">SC-${i}:</span>
                    <input type="number" name="sc${i}_c" placeholder="C:" step="0.1">
                    <input type="number" name="sc${i}_d" placeholder="D:" step="0.1">
                    <input type="number" name="sc${i}_h" placeholder="H:" step="0.1">
                `;
                container.appendChild(div);
            }
        }
        
        // SCæ©ŸCPU/ãƒ¡ãƒ¢ãƒªã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å‹•çš„ã«ç”Ÿæˆ
        function generateSCCpuMemoryInputs() {
            const container = document.getElementById('scCpuMemory');
            for (let i = 1; i <= 12; i++) {
                const div = document.createElement('div');
                div.className = 'sc-cpu-inputs';
                div.innerHTML = `
                    <span class="sc-label">SC-${i}:</span>
                    <input type="number" name="sc${i}_cpu" placeholder="CPU[%]" min="0" max="100" step="0.1">
                    <input type="number" name="sc${i}_memory" placeholder="ãƒ¡ãƒ¢ãƒª[GB]" step="0.01">
                `;
                container.appendChild(div);
            }
        }
        
        // è¨­å®šã®ä¿å­˜ã¨èª­ã¿è¾¼ã¿
        function loadConfig() {
            const token = localStorage.getItem('githubToken');
            const owner = localStorage.getItem('repoOwner');
            const repo = localStorage.getItem('repoName');
            
            if (token) document.getElementById('githubToken').value = token;
            if (owner) document.getElementById('repoOwner').value = owner;
            if (repo) document.getElementById('repoName').value = repo;
        }
        
        function saveConfig() {
            const token = document.getElementById('githubToken').value;
            const owner = document.getElementById('repoOwner').value;
            const repo = document.getElementById('repoName').value;
            
            if (token) localStorage.setItem('githubToken', token);
            if (owner) localStorage.setItem('repoOwner', owner);
            if (repo) localStorage.setItem('repoName', repo);
        }
        
        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
        function switchTab(tabName) {
            // ã™ã¹ã¦ã®ã‚¿ãƒ–ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒªã‚»ãƒƒãƒˆ
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // é¸æŠã•ã‚ŒãŸã‚¿ãƒ–ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã™ã‚‹
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }
        
        // GitHubé€ä¿¡æ©Ÿèƒ½
        async function submitToGitHub() {
            // è¨­å®šã‚’ä¿å­˜
            saveConfig();
            
            // è¨­å®šã®ç¢ºèª
            const token = document.getElementById('githubToken').value;
            const owner = document.getElementById('repoOwner').value;
            const repo = document.getElementById('repoName').value;
            
            if (!token || !owner || !repo) {
                showAlert('GitHubè¨­å®šã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                return;
            }
            
            showLoading(true);
            
            try {
                // ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’åé›†
                const formData = new FormData(document.getElementById('monitoringForm'));
                const data = Object.fromEntries(formData.entries());
                
                // GitHub APIã§ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ãƒˆãƒªã‚¬ãƒ¼ï¼ˆrepository_dispatchï¼‰
                const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/dispatches`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        event_type: 'update-monitoring-data',
                        client_payload: {
                            data: JSON.stringify(data)
                        }
                    })
                });
                
                if (response.ok) {
                    showAlert('ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã—ã¾ã—ãŸï¼GitHub Actionsã§å‡¦ç†ä¸­ã§ã™ã€‚', 'success');
                    // é€ä¿¡æˆåŠŸã—ãŸã‚‰ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’ã‚¯ãƒªã‚¢
                    localStorage.removeItem('monitoringData');
                    // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆæ—¥æ™‚ã¨ç¢ºèªè€…ä»¥å¤–ï¼‰
                    const currentChecker = document.getElementById('checker').value;
                    document.getElementById('monitoringForm').reset();
                    document.getElementById('date').value = new Date().toISOString().split('T')[0];
                    document.getElementById('time').value = new Date().toTimeString().split(' ')[0].substring(0, 5);
                    document.getElementById('checker').value = currentChecker;
                } else {
                    const error = await response.text();
                    throw new Error(`é€ä¿¡å¤±æ•—: ${response.status} - ${error}`);
                }
            } catch (error) {
                console.error('Error:', error);
                showAlert(`ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`, 'error');
            } finally {
                showLoading(false);
            }
        }
        
        // ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
        function downloadFile(content, filename, contentType) {
            const blob = new Blob([content], { type: contentType });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }
        
        // JSONãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        function downloadJSON() {
            const formData = new FormData(document.getElementById('monitoringForm'));
            const data = Object.fromEntries(formData.entries());
            
            // å¿…é ˆé …ç›®ãƒã‚§ãƒƒã‚¯
            if (!data.date || !data.time || !data.checker) {
                showAlert('åŸºæœ¬æƒ…å ±ï¼ˆç¢ºèªæ—¥ã€ç¢ºèªæ™‚åˆ»ã€ç¢ºèªè€…ï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                return;
            }
            
            const jsonContent = JSON.stringify(data, null, 2);
            const filename = `monitoring_${data.date}_${data.time.replace(':', '')}.json`;
            
            downloadFile(jsonContent, filename, 'application/json');
            showAlert('JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸã€‚Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã§å¤‰æ›ã—ã¦ãã ã•ã„', 'success');
        }
        
        // CSVãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        function downloadCSV() {
            const formData = new FormData(document.getElementById('monitoringForm'));
            const data = Object.fromEntries(formData.entries());
            
            // å¿…é ˆé …ç›®ãƒã‚§ãƒƒã‚¯
            if (!data.date || !data.time || !data.checker) {
                showAlert('åŸºæœ¬æƒ…å ±ï¼ˆç¢ºèªæ—¥ã€ç¢ºèªæ™‚åˆ»ã€ç¢ºèªè€…ï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                return;
            }
            
            // CSVãƒ˜ãƒƒãƒ€ãƒ¼
            const csvHeaders = [
                'ç¢ºèªæ—¥', 'ç¢ºèªè€…', 'ç¢ºèªçµæœ', 'ã‚µãƒ¼ãƒæ™‚åˆ»åŒæœŸ', 'CPUãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«', 'SCSIã‚¨ãƒ³ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£',
                'C:ãƒ‰ãƒ©ã‚¤ãƒ–[GB]', 'D:ãƒ‰ãƒ©ã‚¤ãƒ–[GB]', 'E:ãƒ‰ãƒ©ã‚¤ãƒ–[GB]', 'Y:ãƒ‰ãƒ©ã‚¤ãƒ–[GB]', 'Z:ãƒ‰ãƒ©ã‚¤ãƒ–[TB]',
                'SQLServerãƒ¡ãƒ¢ãƒª[GB]', 'å…¨ä½“ãƒ¡ãƒ¢ãƒª[GB]', 'ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡çŠ¶æ³', 'CPUä½¿ç”¨ç‡[%]', 'CPUç¢ºèªæ™‚åˆ»',
                'ä¸Šæ®µãƒ©ãƒ³ãƒ—[å€‹]', 'ä¸‹æ®µãƒ©ãƒ³ãƒ—[å€‹]', 'å‚™è€ƒ'
            ];
            
            // CSVãƒ‡ãƒ¼ã‚¿è¡Œ
            const csvRow = [
                data.date || '',  // æ—¥ä»˜ã®ã¿ï¼ˆæ™‚åˆ»ã¯é™¤å»ï¼‰
                data.checker || '',
                data.checkResult || '',
                data.serverTimeSync || '',
                data.cpuPciModule || '',
                data.scsiEnclosure || '',
                data.driveC || '',
                data.driveD || '',
                data.driveE || '',
                data.driveY || '',
                data.driveZ || '',
                data.sqlServerMemory || '',
                data.totalMemory || '',
                data.memoryUsageStatus || '',
                data.cpuUsage || '',
                data.cpuUsageTime || '',
                data.upperLamps || '',
                data.lowerLamps || '',
                data.notes || ''
            ];
            
            // SCæ©ŸHDDãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
            for (let i = 1; i <= 12; i++) {
                csvHeaders.push(`SC-${i}_C:[GB]`, `SC-${i}_D:[GB]`, `SC-${i}_H:[GB]`);
                csvRow.push(
                    data[`sc${i}_c`] || '',
                    data[`sc${i}_d`] || '',
                    data[`sc${i}_h`] || ''
                );
            }
            
            // SCæ©ŸCPU/ãƒ¡ãƒ¢ãƒªãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
            for (let i = 1; i <= 12; i++) {
                csvHeaders.push(`SC-${i}_CPU:[%]`, `SC-${i}_Memory:[GB]`);
                csvRow.push(
                    data[`sc${i}_cpu`] || '',
                    data[`sc${i}_memory`] || ''
                );
            }
            
            // CSVå½¢å¼ã«å¤‰æ›
            const csvContent = [
                csvHeaders.join(','),
                csvRow.map(field => `"${field}"`).join(',')
            ].join('\n');
            
            const filename = `monitoring_${data.date}_${data.time.replace(':', '')}.csv`;
            downloadFile('\uFEFF' + csvContent, filename, 'text/csv;charset=utf-8');
            showAlert('CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ', 'success');
        }
        
        // ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤º
        function showAlert(message, type = 'info') {
            const alert = document.getElementById('alert');
            alert.className = `alert alert-${type}`;
            alert.textContent = message;
            alert.style.display = 'block';
            
            setTimeout(() => {
                alert.style.display = 'none';
            }, 5000);
        }
        
        // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
        function showLoading(show = true) {
            document.getElementById('loading').style.display = show ? 'flex' : 'none';
        }
        
        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
        function saveToLocal() {
            const formData = new FormData(document.getElementById('monitoringForm'));
            const data = Object.fromEntries(formData.entries());
            
            localStorage.setItem('monitoringData', JSON.stringify(data));
            showAlert('ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ™‚ä¿å­˜ã—ã¾ã—ãŸ', 'success');
        }
        
        // ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
        function loadSavedData() {
            const saved = localStorage.getItem('monitoringData');
            if (saved) {
                const data = JSON.parse(saved);
                Object.keys(data).forEach(key => {
                    const element = document.querySelector(`[name="${key}"]`);
                    if (element) element.value = data[key];
                });
                showAlert('å‰å›ã®ä¸€æ™‚ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ', 'info');
            }
        }
    </script>
</body>
</html>